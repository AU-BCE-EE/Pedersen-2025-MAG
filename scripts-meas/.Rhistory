pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
vignette('ALFAM2-start')
library(ALFAM2)
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(ALFAM2)
vignette('ALFAM2-start')
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(ALFAM2)
vignette('ALFAM2-start')
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
1library(ALFAM2)
library(ALFAM2)
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 100, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 200, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 10, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 10, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 100, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 1, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 100, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(ALFAM2)
dat1 <- data.frame(ctime = 168, TAN.app = 100, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 10, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat1, group = scenario, app.name = 'TAN.app', time.name = 'ctime')
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'os')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
?check
debug(checkDum)
checkDum <- function(dat, vnames = c('^app\\.mthd\\.[ocbt]', '^incorp\\.[ds]', '^man\\.source\\.[cp]')) {
for (i in vnames) {
if (any(grepl(i, names(dat)))) {
dd <- dat[, grepl(i, names(dat)), drop = FALSE]
if (any(dd > 0)) {
rs <- rowSums(dd)
if (any(rs > 1)) {
return(1)
}
}
}
}
return(0)
}
debug(checkDum)
?check
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
1library(ALFAM2)
vignette('ALFAM2-start')
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
library(ALFAM2)
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
check()
devtools()
library(devtools)
check()
check(alfam2)
.libPaths()
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(ALFAM2)
dat
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat1
dat <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
names(dat)
c('app.mthd.os', 'app.mthd.cs') %in% names(dat)
any(c('app.mthd.os', 'app.mthd.cs') %in% names(dat))
'app.rate.ni' %in% names(dat)
any(dat[, grepl('app.mthd.[oc]s', names(dat))] == 1)
dat
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
library(ALFAM2)
dat <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat
pred1 <- alfam2(dat, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(scenario = c(1, 2, 3), ctime = 168, TAN.app = 40, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
library(ALFAM2)
dat <- data.frame(scenario = c(1, 2, 3), ctime = 168, TAN.app = 40, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(scenario = c(1, 2, 3), ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(ctime = 168, TAN.app = 40, group = 'app.mthd',
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
vignette('ALFAM2-start')
vignette('ALFAM2-start')
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', app.rate = 'app.rate', time.name = 'ctime', check = TRUE)
dat <- data.frame(ctime = 168, TAN.app = 40, app.rate = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', app.rate = 'app.rate', time.name = 'ctime', check = TRUE)
pred1
dat <- data.frame(ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
dat <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3
app.mthd = c('bc', 'os', 'cs'))
dat <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
dat <- data.frame(ctime = 168, TAN.app = 50,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 50,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 60,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 100,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 60,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
library(ALFAM2)
version(alfam2)
packageVersion(alfam2)
packageVersion(ALFAM2)
library(ALFAM2)
packageVersion(ALFAM2)
packageVersion(ALFAM2.R)
packageVersion(ALFAM2)
?alfam2
dat1 <- data.frame(ctime = 168, TAN.app = 60,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
> alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', g
alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', g
roup = 'app.mthd')
alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'), check = FALSE)
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2', force = TRUE)
args(ALFAM2)
library(ALFAM2)
args(ALFAM2)
library(ALFAM2)
library(ALFAM2)
args(ALFAM2)
args(alfam)
args(alfam2)
oo <- options(repos = "https://cran.r-project.org/")
utils::install.packages("Matrix")
utils::install.packages("lme4")
options(oo)
install.packages("plyr")
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Pedersen-2025-MAG/scripts-meas")
rm(list = ls())
source('functions.R')
source('packages.R')
source('load.R')
source('subset.R')
source('D3_times.R')
source('summary.R')
#render('stats.Rmd', output_file = '../stats-meas/stats.pdf')
source('export.R')
# plot for technical note, combining the two above
fsumm1 <- fsumm[fsumm$new.ID == '9' | fsumm$new.ID == '10' | fsumm$new.ID == '15', ]
new.ID2 <- c(`9` =  'Trial 2a',
`10` =  'Trial 2b',
`15` =  'Trial 4')
fsumm1[, new.ID2 := new.ID2[new.ID]]
treat2_labels <- c(
`2-Pos` = '2 positions',
`7-Pos` = '7 positions',
`No` = '1 position',
`TH` = 'TH 12 km^-1',
`TH-4` = 'TH 4 km^-1',
`TS1` = 'TS 12 km^-1',
`TS1-4` = 'TS 4 km^-1'
)
fsumm1[, treat2 := treat2_labels[treat1]]
treat2_expressions <- c(
`2 positions` = expression("2 positions"),
`7 positions` = expression("7 positions"),
`1 position` = expression("1 position"),
`TH 12 km^-1` = expression("TH 12 km"^-1),
`TH 4 km^-1` = expression("TH 4 km"^-1),
`TS 12 km^-1` = expression("TS 12 km"^-1),
`TS 4 km^-1` = expression("TS 4 km"^-1)
)
fsumm1[, treat2 := factor(treat2, levels = c(
'TH 12 km^-1',
'TH 4 km^-1',
'TS 12 km^-1',
'TS 4 km^-1',
'1 position',
'2 positions',
'7 positions'
))]
ggplot(fsumm1, aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(size = 0.5) +
geom_line() +
geom_ribbon(aes(
ymax = j.rel.mn + j.rel.sd,
ymin = j.rel.mn - j.rel.sd,
group = treat2
), alpha = 0.3, color = NA) +
facet_wrap(~ new.ID2, scales = 'free_y') +
scale_color_discrete(labels = treat2_expressions) +
scale_fill_discrete(labels = treat2_expressions) +
theme_bw() +
ylab(expression(paste('Flux (frac TAN  ', h^-1,')'))) +
xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 75)
# plot for technical note, combining the two above
fsumm1 <- fsumm[fsumm$new.ID == '9' | fsumm$new.ID == '10' | fsumm$new.ID == '15', ]
new.ID2 <- c(`9` =  'Trial 2a',
`10` =  'Trial 2b',
`15` =  'Trial 4')
fsumm1[, new.ID2 := new.ID2[new.ID]]
treat2_labels <- c(
`2-Pos` = '2 positions',
`7-Pos` = '7 positions',
`No` = '1 position',
`TH` = 'Trailing hose 12 km^-1',
`TH-4` = 'Trailing hose 4 km^-1',
`TS1` = 'Trailing shoe 12 km^-1',
`TS1-4` = 'Trailing shoe 4 km^-1'
)
fsumm1[, treat2 := treat2_labels[treat1]]
treat2_expressions <- c(
`2 positions` = expression("2 positions"),
`7 positions` = expression("7 positions"),
`1 position` = expression("1 position"),
`TH 12 km^-1` = expression("Trailing hose 12 km"^-1),
`TH 4 km^-1` = expression("Trailing hose 4 km"^-1),
`TS 12 km^-1` = expression("Trailing shoe 12 km"^-1),
`TS 4 km^-1` = expression("Trailing shoe 4 km"^-1)
)
fsumm1[, treat2 := factor(treat2, levels = c(
'Trailing hose 12 km^-1',
'Trailing hose 4 km^-1',
'Trailing shoe 12 km^-1',
'Trailing shoe 4 km^-1',
'1 position',
'2 positions',
'7 positions'
))]
ggplot(fsumm1, aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(size = 0.5) +
geom_line() +
geom_ribbon(aes(
ymax = j.rel.mn + j.rel.sd,
ymin = j.rel.mn - j.rel.sd,
group = treat2
), alpha = 0.3, color = NA) +
facet_wrap(~ new.ID2, scales = 'free_y') +
scale_color_discrete(labels = treat2_expressions) +
scale_fill_discrete(labels = treat2_expressions) +
theme_bw() +
ylab(expression(paste('Flux (frac TAN  ', h^-1,')'))) +
xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 75)
ggsave2x('../plots-meas/tech.note', height = 4, width = 8)
# plot for technical note, combining the two above
fsumm1 <- fsumm[fsumm$new.ID == '9' | fsumm$new.ID == '10' | fsumm$new.ID == '15', ]
new.ID2 <- c(`9` =  'Trial 2a',
`10` =  'Trial 2b',
`15` =  'Trial 4')
fsumm1[, new.ID2 := new.ID2[new.ID]]
treat2_labels <- c(
`2-Pos` = '2 positions',
`7-Pos` = '7 positions',
`No` = '1 position',
`TH` = 'Trailing hose 12 km^-1',
`TH-4` = 'Trailing hose 4 km^-1',
`TS1` = 'Trailing shoe 12 km^-1',
`TS1-4` = 'Trailing shoe 4 km^-1'
)
fsumm1[, treat2 := treat2_labels[treat1]]
treat2_expressions <- c(
`2 positions` = expression("2 positions"),
`7 positions` = expression("7 positions"),
`1 position` = expression("1 position"),
`Trailing hose 12 km^-1` = expression("Trailing hose 12 km"^-1),
`Trailing hose 4 km^-1` = expression("Trailing hose 4 km"^-1),
`Trailing shoe 12 km^-1` = expression("Trailing shoe 12 km"^-1),
`Trailing shoe 4 km^-1` = expression("Trailing shoe 4 km"^-1)
)
fsumm1[, treat2 := factor(treat2, levels = c(
'Trailing hose 12 km^-1',
'Trailing hose 4 km^-1',
'Trailing shoe 12 km^-1',
'Trailing shoe 4 km^-1',
'1 position',
'2 positions',
'7 positions'
))]
ggplot(fsumm1, aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(size = 0.5) +
geom_line() +
geom_ribbon(aes(
ymax = j.rel.mn + j.rel.sd,
ymin = j.rel.mn - j.rel.sd,
group = treat2
), alpha = 0.3, color = NA) +
facet_wrap(~ new.ID2, scales = 'free_y') +
scale_color_discrete(labels = treat2_expressions) +
scale_fill_discrete(labels = treat2_expressions) +
theme_bw() +
ylab(expression(paste('Flux (frac TAN  ', h^-1,')'))) +
xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 75)
ggsave2x('../plots-meas/tech.note', height = 4, width = 8)
ggplot(fsumm1[fsumm1$new.ID2 == 'Trial 4', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(size = 0.5) +
geom_line() +
geom_ribbon(aes(
ymax = j.rel.mn + j.rel.sd,
ymin = j.rel.mn - j.rel.sd,
group = treat2
), alpha = 0.2, color = NA) +
facet_wrap(~ new.ID2, scales = 'free_y') +
scale_color_discrete(labels = treat2_expressions) +
scale_fill_discrete(labels = treat2_expressions) +
theme_bw() +
ylab(expression(paste('Flux (frac TAN  ', h^-1,')'))) +
xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 75)
ggsave2x('../plots-meas/tech.note_t4', height = 4, width = 6)
