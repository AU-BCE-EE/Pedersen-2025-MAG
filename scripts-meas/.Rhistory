ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = leg.lab, fill = leg.lab)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
#  geom_text(data = labs[labs$new.ID == '3', ], x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom') +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = leg.lab, fill = leg.lab)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
geom_text(data = labs[labs$new.ID == '7', ], x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(legend.position = 'none') +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = leg.lab, fill = leg.lab)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
geom_text(data = labs[labs$new.ID == '3', ], x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'none') +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = leg.lab, fill = leg.lab)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
#  geom_text(data = labs[labs$new.ID == '7', ], x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom') +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
fsumm.treat02 <- fsumm.treat[fsumm.treat$new.ID == '5' | fsumm.treat$new.ID == '6' | fsumm.treat$new.ID == '7' | fsumm.treat$new.ID == '8', ]
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = leg.lab, fill = leg.lab)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
#  geom_text(data = labs[labs$new.ID == '7', ], x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom') +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
View(fsumm.treat02)
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
#  geom_text(data = labs[labs$new.ID == '7', ], x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom') +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
#  geom_text(data = labs[labs$new.ID == '7', ], x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = 'none') +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
#  geom_text(data = labs[labs$new.ID == '7', ], x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
#  geom_text(data = labs[labs$new.ID == '7', ], x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'none') +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
treat2 <- c(`A` =  'Dig. A',
`B` =  'Dig. B',
`C` =  'Dig. C',
`B Sep-S` =  'Dig. B liquid',
`C Sep-D` =  'Dig. C liquid')
fsumm.treat01[, treat2 := treat2[treat1]]
ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, labeller = as_labeller(c('3' = 'Trial 3'))) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggsave2x('../plots-meas/NH3.flux3.Ramiran', height = 2, width = 3)
ggsave2x('../plots-meas/NH3.flux3.Ramiran', height = 3, width = 4)
ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, labeller = as_labeller(c('3' = 'Trial 3'))) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', ncol = 2, legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggsave2x('../plots-meas/NH3.flux3.Ramiran', height = 3, width = 4)
ggsave2x('../plots-meas/NH3.flux3.Ramiran', height = 3, width = 4.2)
ggsave2x('../plots-meas/NH3.flux3.Ramiran', height = 3, width = 4.5)
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
#  geom_text(data = labs[labs$new.ID == '7', ], x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
treat2 <- c(`TH` =  'Trailing hose',
`TS1` =  'Trailing shoe 1',
`TS2` =  'Trailing shoe 2',
`TS3` =  'Trailing shoe + harrowing tine')
fsumm.treat02[, treat2 := treat2[treat1]]
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggsave2x('../plots-meas/NH3.flux7.Ramiran', height = 3, width = 4.5)
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(color = guide_legend(nrow = 2)) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggsave2x('../plots-meas/NH3.flux7.Ramiran', height = 3, width = 4.5)
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, labeller = as_labeller(c('3' = 'Trial 7'))) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(color = guide_legend(nrow = 2)) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggsave2x('../plots-meas/NH3.flux7.Ramiran', height = 3, width = 4.5)
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, labeller = as_labeller(c('3' = 'Trial 7'))) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(color = guide_legend(nrow = 2)) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, labeller = as_labeller(c('7' = 'Trial 7'))) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(color = guide_legend(nrow = 2)) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggsave2x('../plots-meas/NH3.flux7.Ramiran', height = 3, width = 4.5)
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Pedersen-2025-MAG/scripts-meas")
rm(list = ls())
source('functions.R')
source('packages.R')
source('load.R')
source('subset.R')
source('D3_times.R')
source('summary.R')
#render('stats.Rmd', output_file = '../stats-meas/stats.pdf')
source('export.R')
# dividing dataframe into treat and prop and adding trial ID's
idat.treat <- idat[is.element(idat$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
idat.prop <- idat[is.element(idat$new.ID, c('D1', 'D2', 'D3', 'D4', 'D5')), ]
fsumm.treat <- fsumm[is.element(fsumm$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
# flux over time
# all:
ggplot(idat, aes(cta, j.NH3, group = pmid, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = expression('NH'[3]~'flux'~('kg N h'^'-1'~ha^'-1'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux01', height = 10, width = 10)
# # plot for ramiran poster - not used
# ggplot(idat.treat, aes(cta, j.NH3, group = pmid)) +
#   geom_line(size = 0.2) +
#   theme_bw() +
#   labs(x = 'Time after application (h)', y = expression('NH'[3]~'flux'~('kg N h'^'-1'~ha^'-1'))) +
#   theme(legend.position = 'bottom', legend.title = element_blank()) +
#   xlim(NA, 150)
# ggsave2x('../plots-meas/NH3.flux.ramiran', height = 3, width = 6)
fsumm.treat01 <- fsumm.treat[fsumm.treat$new.ID == '1' | fsumm.treat$new.ID == '2' | fsumm.treat$new.ID == '3' | fsumm.treat$new.ID == '4', ]
fsumm.treat01 <- fsumm.treat01[! c(fsumm.treat01$new.ID == '3' & fsumm.treat01$treat1 == 'B Sep-S' & fsumm.treat01$cta == '0'), ]
# Create and sort factor for plot labels
setorder(fsumm.treat01, new.ID, treat1)
ll <- unique(fsumm.treat01[, treat1])
labs <- data.table(treat1 = ll, i = as.integer(factor(ll, levels = ll)))
labs[, leg.lab := paste0(i, '. ', treat1)]
fsumm.treat01[, tfact := factor(treat1, levels = ll)]
fsumm.treat01[, leg.lab := factor(paste0(as.integer(tfact), '. ', tfact), levels = labs$leg.lab)]
# Manual adjustments to avoid overplotting
adj <- data.table(i      = c(4,           6,      9,     1,      4,     7, 11, 10),
new.ID = c(1,           2,      2,     3,      4,     3, 3, 3),
yshift = c(-0.002, -0.003, -0.002, 0.003, -0.001, 0.001, -0.003, -0.002))
adj[, new.ID := as.character(new.ID)]
# Get integer codes and initial emission
d0 <- fsumm.treat01[, .(y = j.rel.mn[cta == min(cta)]), by = .(new.ID, leg.lab)]
labs <- merge(labs, d0)
labs <- merge(labs, adj, all = TRUE, by = c('i', 'new.ID'))
labs[is.na(yshift), yshift := 0]
labs[, y := y + yshift]
f1 <- ggplot(fsumm.treat01, aes(cta, j.rel.mn, color = leg.lab, fill = leg.lab)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
geom_text(data = labs, x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (frac. TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(colour = guide_legend(nrow = 3, byrow = TRUE)) +
xlim(-2, 150)
f11 <- ggplot(fsumm.treat01, aes(cta, j.rel.mn, color = leg.lab, fill = leg.lab)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
geom_text(data = labs, x = 2, aes(y = y, label = i), hjust = 1, size = 3.2, show.legend = FALSE) +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (frac. TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(colour = guide_legend(nrow = 3, byrow = TRUE)) +
xlim(-0.2, 50)
fsumm.treat02 <- fsumm.treat[fsumm.treat$new.ID == '5' | fsumm.treat$new.ID == '6' | fsumm.treat$new.ID == '7' | fsumm.treat$new.ID == '8', ]
f2 <- ggplot(fsumm.treat02, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (frac. TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.025) +
xlim(NA, 150)
# ggsave2x('../plots-meas/NH3.flux.treat02', height = 3.5, width = 8)
f22 <- ggplot(fsumm.treat02, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (frac. TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.025) +
xlim(NA, 50)
fsumm.treat03 <- fsumm.treat[fsumm.treat$new.ID == '9' | fsumm.treat$new.ID == '10' | fsumm.treat$new.ID == '11' | fsumm.treat$new.ID == '12', ]
fsumm.treat03 <- fsumm.treat03[! fsumm.treat03$treat == 'TH-4', ]
fsumm.treat03 <- fsumm.treat03[! fsumm.treat03$treat == 'TS1-4', ]
fsumm.treat03 <- fsumm.treat03[! fsumm.treat03$treat == 'TS1 + acid', ]
fsumm.treat03$new.ID.f <- factor(fsumm.treat03$new.ID, levels = c('9', '10', '11', '12'))
f3 <- ggplot(fsumm.treat03, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (frac. TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.075) +
xlim(NA, 150)
# ggsave2x('../plots-meas/NH3.flux.treat03', height = 3.5, width = 8)
f33 <- ggplot(fsumm.treat03, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (frac. TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.075) +
xlim(NA, 50)
mat <- matrix(c(1, 1, 1, 1,
2, 2, 2,
3, 3, 3),
ncol = 1)
pff <- grid.arrange(f1, f2, f3, layout_matrix = mat)
ggsave2x('../plots-meas/NH3.flux.comm.150', plot = pff, height = 10, width = 8)
mat <- matrix(c(1, 1, 1, 1,
2, 2, 2,
3, 3, 3),
ncol = 1)
pfff <- grid.arrange(f11, f22, f33, layout_matrix = mat)
ggsave2x('../plots-meas/NH3.flux.comm.50', plot = pfff, height = 10, width = 8)
treat2 <- c(`A` =  'Dig. A',
`B` =  'Dig. B',
`C` =  'Dig. C',
`B Sep-S` =  'Dig. B liquid',
`C Sep-D` =  'Dig. C liquid')
fsumm.treat01[, treat2 := treat2[treat1]]
treat2 <- c(`TH` =  'Trailing hose',
`TS1` =  'Trailing shoe 1',
`TS2` =  'Trailing shoe 2',
`TS3` =  'Trailing shoe + harrowing tine')
fsumm.treat02[, treat2 := treat2[treat1]]
ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, labeller = as_labeller(c('3' = 'Trial 3'))) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', ncol = 2, legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggsave2x('../plots-meas/NH3.flux3.Ramiran', height = 3, width = 5)
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, labeller = as_labeller(c('7' = 'Trial 7'))) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(color = guide_legend(nrow = 2)) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggsave2x('../plots-meas/NH3.flux7.Ramiran', height = 3, width = 5)
ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, labeller = as_labeller(c('3' = 'Trial 3'))) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', ncol = 1, legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggplot(fsumm.treat02[fsumm.treat02$new.ID == '7', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, labeller = as_labeller(c('7' = 'Trial 7'))) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(color = guide_legend(nrow = 1)) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggsave2x('../plots-meas/NH3.flux7.Ramiran', height = 3, width = 5)
ggsave2x('../plots-meas/NH3.flux7.Ramiran', height = 3.5, width = 5.5)
ggsave2x('../plots-meas/NH3.flux7.Ramiran', height = 3, width = 5.5)
ggplot(fsumm.treat01[fsumm.treat01$new.ID == '3', ], aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) +
geom_line() +
facet_wrap(~ new.ID, labeller = as_labeller(c('3' = 'Trial 3'))) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat2), alpha = 0.3, color = NA) +
ylab(expression(paste(NH[3], '  flux'))) + xlab('Time from application (h)') +
theme(axis.text.y = element_blank()) +
theme(legend.position = 'bottom', ncol = 1, legend.title = element_blank()) +
xlim(-0.2, 50) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1")
ggsave2x('../plots-meas/NH3.flux3.Ramiran', height = 3, width = 5.5)
