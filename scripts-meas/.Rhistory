dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'), check = FALSE)
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2', force = TRUE)
args(ALFAM2)
library(ALFAM2)
args(ALFAM2)
library(ALFAM2)
library(ALFAM2)
args(ALFAM2)
args(alfam)
args(alfam2)
oo <- options(repos = "https://cran.r-project.org/")
utils::install.packages("Matrix")
utils::install.packages("lme4")
options(oo)
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Pedersen-2024-MAG/scripts-meas")
rm(list = ls())
source('functions.R')
source('packages.R')
source('load.R')
source('subset.R')
source('summary.R')
source('stats.R')
source('export.R')
rm(list = ls())
source('functions.R')
source('packages.R')
source('load.R')
source('subset.R')
source('summary.R')
source('stats.R')
write.csv(pdat, '../output/pdat.csv', row.names = FALSE)
write.csv(idat, '../output/idat.csv', row.names = FALSE)
write.csv(wsumm, '../output/temp.csv', row.names = FALSE)
esumm$cum.emis.mn <- paste(esumm$e.rel.150, ' Â± ', esumm$e.rel.150.sd)
# Select some cols from esumm to export
esumm.treat <- esumm[is.element(esumm$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), c('new.ID', 'treat1', 'cum.emis.mn', 'e.rel.150.n')]
esumm.treat.sup <- esumm[is.element(esumm$new.ID, c('9', '10', '13', '14', '15')), c('new.ID', 'treat1', 'cum.emis.mn', 'e.rel.150.n')]
esumm.prop <- esumm[is.element(esumm$new.ID, c('D1', 'D2', 'D3', 'D4', 'D5')), c('new.ID', 'treat1', 'cum.emis.mn', 'e.rel.150.n')]
# tables with cumulative emission
write.csv(esumm.treat, '../output/cum.emis.treat.csv', row.names = FALSE)
write.csv(esumm.treat.sup, '../output/cum.emis.treat.sup.csv', row.names = FALSE)
write.csv(esumm.prop, '../output/cum.emis.prop.csv', row.names = FALSE)
idat.treat <- idat[is.element(idat$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
idat.prop <- idat[is.element(idat$new.ID, c('D1', 'D2', 'D3', 'D4', 'D5')), ]
fsumm.treat <- fsumm[is.element(fsumm$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
# flux over time
# all:
ggplot(idat, aes(cta, j.NH3, group = pmid, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = expression('NH'[3]~'flux'~('kg N h'^'-1'~ha^'-1'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
fsumm.treat01 <- fsumm.treat[fsumm.treat$new.ID == '1' | fsumm.treat$new.ID == '2' | fsumm.treat$new.ID == '3' | fsumm.treat$new.ID == '4', ]
ggplot(fsumm.treat01, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
fsumm.treat01 <- fsumm.treat[fsumm.treat$new.ID == '1' | fsumm.treat$new.ID == '2' | fsumm.treat$new.ID == '3' | fsumm.treat$new.ID == '4', ]
ggplot(fsumm.treat01, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.treat01', height = 4, width = 8)
fsumm.treat02 <- fsumm.treat[fsumm.treat$new.ID == '5' | fsumm.treat$new.ID == '6' | fsumm.treat$new.ID == '7' | fsumm.treat$new.ID == '8', ]
ggplot(fsumm.treat02, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux01.treat02', height = 4, width = 8)
fsumm.treat03 <- fsumm.treat[fsumm.treat$new.ID == '9' | fsumm.treat$new.ID == '10' | fsumm.treat$new.ID == '11' | fsumm.treat$new.ID == '12', ]
fsumm.treat03 <- fsumm.treat03[! fsumm.treat03$treat == 'TH-4', ]
fsumm.treat03 <- fsumm.treat03[! fsumm.treat03$treat == 'TS1-4', ]
fsumm.treat03 <- fsumm.treat03[! fsumm.treat03$treat == 'TS1 + acid', ]
ggplot(fsumm.treat03, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.treat03', height = 4, width = 8)
fsumm.treat01 <- fsumm.treat[fsumm.treat$new.ID == '1' | fsumm.treat$new.ID == '2' | fsumm.treat$new.ID == '3' | fsumm.treat$new.ID == '4', ]
fsumm.treat01 <- fsumm.treat01[! fsumm.treat01$new.ID == '3' & fsumm.treat01$treat1 == 'B Sep-S', ]
fsumm.treat01 <- fsumm.treat[fsumm.treat$new.ID == '1' | fsumm.treat$new.ID == '2' | fsumm.treat$new.ID == '3' | fsumm.treat$new.ID == '4', ]
fsumm.treat01 <- fsumm.treat01[! c(fsumm.treat01$new.ID == '3' & fsumm.treat01$treat1 == 'B Sep-S'), ]
ggplot(fsumm.treat01, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.treat01', height = 4, width = 8)
fsumm.treat02 <- fsumm.treat[fsumm.treat$new.ID == '5' | fsumm.treat$new.ID == '6' | fsumm.treat$new.ID == '7' | fsumm.treat$new.ID == '8', ]
ggplot(fsumm.treat02, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.treat02', height = 4, width = 8)
ggplot(fsumm.treat01, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(fill = guide_legend(nrow = 2,byrow = TRUE)) +
xlim(NA, 150)
ggplot(fsumm.treat01, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(colour = guide_legend(nrow = 2,byrow = TRUE)) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.treat01', height = 4, width = 8)
ggplot(fsumm.treat02, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.025)
ggplot(fsumm.treat02, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.025) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.treat02', height = 3.5, width = 8)
ggplot(fsumm.treat03, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim, NA, 0.075) +
ggsave2x('../plots-meas/NH3.flux.treat03', height = 3.5, width = 8)
ggplot(fsumm.treat03, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.075) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.treat03', height = 3.5, width = 8)
f3 <- ggplot(fsumm.treat03, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.075) +
xlim(NA, 150)
f2 <- ggplot(fsumm.treat02, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.025) +
xlim(NA, 150)
f1 <- ggplot(fsumm.treat01, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(colour = guide_legend(nrow = 2,byrow = TRUE)) +
xlim(NA, 150)
mat <- matrix(c(1,
2,
3),
ncol = 1)
pff <- grid.arrange(f1, f2, f3, layout_matrix = mat)
??grid.arrange
library(gridExtra)
pff <- grid.arrange(f1, f2, f3, layout_matrix = mat)
ggsave2x('../plots-meas/flux.comm.150', plot = pfw, height = 11, width = 8)
ggsave2x('../plots-meas/flux.comm.150', plot = pff, height = 11, width = 8)
f33 <- ggplot(fsumm.treat03, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.075) +
xlim(NA, 50)
f22 <- ggplot(fsumm.treat02, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.025) +
xlim(NA, 150)
f11 <- ggplot(fsumm.treat01, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(colour = guide_legend(nrow = 2,byrow = TRUE)) +
xlim(NA, 50)
f22 <- ggplot(fsumm.treat02, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.025) +
xlim(NA, 50)
ggsave2x('../plots-meas/NH3.flux.comm.150', plot = pff, height = 11, width = 8)
ggsave2x('../plots-meas/flux.comm.50', plot = pfff, height = 11, width = 8)
pfff <- grid.arrange(f11, f22, f33, layout_matrix = mat)
ggsave2x('../plots-meas/flux.comm.50', plot = pfff, height = 11, width = 8)
# dividing dataframe into treat and prop and adding trial ID's
idat.treat <- idat[is.element(idat$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
idat.prop <- idat[is.element(idat$new.ID, c('D1', 'D2', 'D3', 'D4', 'D5')), ]
fsumm.treat <- fsumm[is.element(fsumm$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
# flux over time
# all:
ggplot(idat, aes(cta, j.NH3, group = pmid, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = expression('NH'[3]~'flux'~('kg N h'^'-1'~ha^'-1'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux01', height = 10, width = 10)
fsumm.treat01 <- fsumm.treat[fsumm.treat$new.ID == '1' | fsumm.treat$new.ID == '2' | fsumm.treat$new.ID == '3' | fsumm.treat$new.ID == '4', ]
fsumm.treat01 <- fsumm.treat01[! c(fsumm.treat01$new.ID == '3' & fsumm.treat01$treat1 == 'B Sep-S'), ]
f1 <- ggplot(fsumm.treat01, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(colour = guide_legend(nrow = 2,byrow = TRUE)) +
xlim(NA, 150)
# ggsave2x('../plots-meas/NH3.flux.treat01', height = 4, width = 8)
f11 <- ggplot(fsumm.treat01, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(colour = guide_legend(nrow = 2,byrow = TRUE)) +
xlim(NA, 50)
fsumm.treat02 <- fsumm.treat[fsumm.treat$new.ID == '5' | fsumm.treat$new.ID == '6' | fsumm.treat$new.ID == '7' | fsumm.treat$new.ID == '8', ]
f2 <- ggplot(fsumm.treat02, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.025) +
xlim(NA, 150)
# ggsave2x('../plots-meas/NH3.flux.treat02', height = 3.5, width = 8)
f22 <- ggplot(fsumm.treat02, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.025) +
xlim(NA, 50)
fsumm.treat03 <- fsumm.treat[fsumm.treat$new.ID == '9' | fsumm.treat$new.ID == '10' | fsumm.treat$new.ID == '11' | fsumm.treat$new.ID == '12', ]
fsumm.treat03 <- fsumm.treat03[! fsumm.treat03$treat == 'TH-4', ]
fsumm.treat03 <- fsumm.treat03[! fsumm.treat03$treat == 'TS1-4', ]
fsumm.treat03 <- fsumm.treat03[! fsumm.treat03$treat == 'TS1 + acid', ]
f3 <- ggplot(fsumm.treat03, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.075) +
xlim(NA, 150)
# ggsave2x('../plots-meas/NH3.flux.treat03', height = 3.5, width = 8)
f33 <- ggplot(fsumm.treat03, aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 4) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
ylim(NA, 0.075) +
xlim(NA, 50)
mat <- matrix(c(1,
2,
3),
ncol = 1)
pff <- grid.arrange(f1, f2, f3, layout_matrix = mat)
ggsave2x('../plots-meas/NH3.flux.comm.150', plot = pff, height = 11, width = 8)
mat <- matrix(c(1,
2,
3),
ncol = 1)
pfff <- grid.arrange(f11, f22, f33, layout_matrix = mat)
ggsave2x('../plots-meas/NH3.flux.comm.50', plot = pfff, height = 11, width = 8)
View(fsumm.treat03)
# flux over time
# all:
ggplot(idat, aes(cta, j.NH3, group = pmid, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = expression('NH'[3]~'flux'~('kg N h'^'-1'~ha^'-1'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat[idat$new.ID == '12', ], aes(cta, j.NH3, group = pmid, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = expression('NH'[3]~'flux'~('kg N h'^'-1'~ha^'-1'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
View(idat)
# flux over time
# all:
ggplot(idat, aes(cta, e.cum, group = pmid, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = expression('NH'[3]~'flux'~('kg N h'^'-1'~ha^'-1'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat[idat$new.ID == '12', ], aes(cta, e.cum, group = pmid, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = expression('NH'[3]~'flux'~('kg N h'^'-1'~ha^'-1'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat[idat$new.ID == '12', ], aes(cta, e.cum, group = pmid, color = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line()
ggplot(idat[idat$new.ID == '12', ], aes(cta, e.cum, group = pmid, color = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = expression('NH'[3]~'flux'~('kg N h'^'-1'~ha^'-1'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat[idat$new.ID == '12', ], aes(cta, e.cum, group = pmid, color = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Loss (%TAN)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 85)
idat12 <- idat[!idat$treat1 == 'TS1 + acid', ]
ggplot(idat12[idat12$new.ID == '12', ], aes(cta, e.cum, group = pmid, color = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Loss (%TAN)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 85)
ggsave2x('../plots-meas/NH3.flux.trial12', height = 10, width = 10)
ggplot(idat12[idat12$new.ID == '12', ], aes(cta, e.cum, group = pmid, color = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Loss (%TAN)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 85)
ggsave2x('../plots-meas/NH3.flux.trial12', height = 3, width = 4)
# cumulative loss for trial 11 + 12
idat11.12 <- idat[idat$trial == '11' | idat$trial == '12', ]
idat11.12 <- idat11.12[!idat11.12$treat1 == 'TS1 + acid', ]
ggplot(idat11.12, aes(cta, e.cum, group = pmid, color = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Loss (%TAN)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 85)
# cumulative loss for trial 11 + 12
idat11.12 <- idat[idat$new.ID == '11' | idat$new.ID == '12', ]
idat11.12 <- idat11.12[!idat11.12$treat1 == 'TS1 + acid', ]
ggplot(idat11.12, aes(cta, e.cum, group = pmid, color = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID) +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Loss (%TAN)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 85)
ggsave2x('../plots-meas/NH3.flux.trial12', height = 3, width = 7)
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Pedersen-2024-MAG/scripts-meas")
rm(list = ls())
source('functions.R')
source('packages.R')
source('load.R')
source('subset.R')
source('summary.R')
source('stats.R')
source('export.R')
idat.treat <- idat[is.element(idat$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
idat.prop <- idat[is.element(idat$new.ID, c('D1', 'D2', 'D3', 'D4', 'D5')), ]
fsumm.treat <- fsumm[is.element(fsumm$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
# cumulative emission
ggplot(isumm, aes(treat1, e.rel.150, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(y = 'Loss (% of TAN) h') +
theme(legend.title = element_blank()) +
geom_boxplot(data = esumm, aes(x = treat1, y = e.rel.150, color = treat1), show.legend = FALSE)
ggplot(isumm[isumm$new.ID == '5' | isumm$new.ID == '6'], aes(treat1, e.rel.150, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(y = 'Loss (% of TAN) h') +
theme(legend.title = element_blank()) +
geom_boxplot(data = esumm, aes(x = treat1, y = e.rel.150, color = treat1), show.legend = FALSE)
ggplot(isumm[isumm$new.ID == '5' | isumm$new.ID == '6', ], aes(treat1, e.rel.150, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(y = 'Loss (% of TAN) h') +
theme(legend.title = element_blank()) +
geom_boxplot(data = esumm, aes(x = treat1, y = e.rel.150, color = treat1), show.legend = FALSE)
isummMac <- isumm[isumm$new.ID == '5' | isumm$new.ID == '6', ]
isummMac <- isumm[isumm$new.ID == '5' | isumm$new.ID == '6', ]
ggplot(isummMac, aes(treat1, e.rel.150, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(y = 'Loss (% of TAN) h') +
theme(legend.title = element_blank()) +
geom_boxplot(data = esumm, aes(x = treat1, y = e.rel.150, color = treat1), show.legend = FALSE)
esummMac <- isumm[esumm$new.ID == '5' | esumm$new.ID == '6', ]
ggplot(isummMac, aes(treat1, e.rel.150, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(y = 'Loss (% of TAN) h') +
theme(legend.title = element_blank()) +
geom_boxplot(data = esummMac, aes(x = treat1, y = e.rel.150, color = treat1), show.legend = FALSE)
isummMac <- isumm[isumm$new.ID == '5' | isumm$new.ID == '6', ]
esummMac <- esumm[esumm$new.ID == '5' | esumm$new.ID == '6', ]
ggplot(isummMac, aes(treat1, e.rel.150, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(y = 'Loss (% of TAN) h') +
theme(legend.title = element_blank()) +
geom_boxplot(data = esummMac, aes(x = treat1, y = e.rel.150, color = treat1), show.legend = FALSE)
ggsave2x('../plots-meas/cum.emis.Machine', height = 5, width = 5)
isummMan <- isumm[isumm$new.ID == '1' | isumm$new.ID == '2', ]
esummMan <- esumm[esumm$new.ID == '1' | esumm$new.ID == '2', ]
ggplot(isummMan, aes(treat1, e.rel.150, color = treat1)) +
geom_point() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(y = 'Loss (% of TAN) h') +
theme(legend.title = element_blank()) +
geom_boxplot(data = esummMan, aes(x = treat1, y = e.rel.150, color = treat1), show.legend = FALSE)
ggsave2x('../plots-meas/cum.emis.Manual', height = 5, width = 5)
