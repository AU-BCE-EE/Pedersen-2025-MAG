pred1
dat1 <- data.frame(ctime = 168, TAN.app = 10, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 100, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 1, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 100, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(ALFAM2)
dat1 <- data.frame(ctime = 168, TAN.app = 100, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 10, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat1, group = scenario, app.name = 'TAN.app', time.name = 'ctime')
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'os')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
?check
debug(checkDum)
checkDum <- function(dat, vnames = c('^app\\.mthd\\.[ocbt]', '^incorp\\.[ds]', '^man\\.source\\.[cp]')) {
for (i in vnames) {
if (any(grepl(i, names(dat)))) {
dd <- dat[, grepl(i, names(dat)), drop = FALSE]
if (any(dd > 0)) {
rs <- rowSums(dd)
if (any(rs > 1)) {
return(1)
}
}
}
}
return(0)
}
debug(checkDum)
?check
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
1library(ALFAM2)
vignette('ALFAM2-start')
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
library(ALFAM2)
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
check()
devtools()
library(devtools)
check()
check(alfam2)
.libPaths()
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(ALFAM2)
dat
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat1
dat <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
names(dat)
c('app.mthd.os', 'app.mthd.cs') %in% names(dat)
any(c('app.mthd.os', 'app.mthd.cs') %in% names(dat))
'app.rate.ni' %in% names(dat)
any(dat[, grepl('app.mthd.[oc]s', names(dat))] == 1)
dat
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
library(ALFAM2)
dat <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat
pred1 <- alfam2(dat, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(scenario = c(1, 2, 3), ctime = 168, TAN.app = 40, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
library(ALFAM2)
dat <- data.frame(scenario = c(1, 2, 3), ctime = 168, TAN.app = 40, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(scenario = c(1, 2, 3), ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(ctime = 168, TAN.app = 40, group = 'app.mthd',
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
vignette('ALFAM2-start')
vignette('ALFAM2-start')
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', app.rate = 'app.rate', time.name = 'ctime', check = TRUE)
dat <- data.frame(ctime = 168, TAN.app = 40, app.rate = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', app.rate = 'app.rate', time.name = 'ctime', check = TRUE)
pred1
dat <- data.frame(ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
dat <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3
app.mthd = c('bc', 'os', 'cs'))
dat <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
dat <- data.frame(ctime = 168, TAN.app = 50,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 50,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 60,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 100,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 60,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
library(ALFAM2)
version(alfam2)
packageVersion(alfam2)
packageVersion(ALFAM2)
library(ALFAM2)
packageVersion(ALFAM2)
packageVersion(ALFAM2.R)
packageVersion(ALFAM2)
?alfam2
dat1 <- data.frame(ctime = 168, TAN.app = 60,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
> alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', g
alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', g
roup = 'app.mthd')
alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'), check = FALSE)
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2', force = TRUE)
args(ALFAM2)
library(ALFAM2)
args(ALFAM2)
library(ALFAM2)
library(ALFAM2)
args(ALFAM2)
args(alfam)
args(alfam2)
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Pedersen-2024-MAG/scripts-meas")
rm(list = ls())
source('functions.R')
source('packages.R')
source('load.R')
source('subset.R')
source('summary.R')
source('export.R')
# temperature
ggplot(idat[idat$treat == 'A' & idat$rep == '1' | idat$treat == '2-pos' & idat$rep == '1' | idat$treat == 'TS-TSB-4' & idat$rep == '1' | idat$treat == 'TH' & idat$rep == '1' | idat$treat == 'Un12' & idat$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ trial, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat.treat[idat.treat$treat == 'A' & idat.treat$rep == '1' | idat.treat$treat == '2-pos' & idat.treat$rep == '1' | idat.treat$treat == 'TS-TSB-4' & idat.treat$rep == '1' | idat.treat$treat == 'TH' & idat.treat$rep == '1' | idat.treat$treat == 'Un12' & idat.treat$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
idat.treat <- idat[is.element(idat$exper, c('23C', '23D', '23G', '24M', '24B', '24C', '24D', '24H', '24J', '24L', '24N', '24O')), ]
idat.prop <- idat[is.element(idat$exper, c('23H', '23I', '24E', '24F', '24G')), ]
ggplot(idat.treat[idat.treat$treat == 'A' & idat.treat$rep == '1' | idat.treat$treat == '2-pos' & idat.treat$rep == '1' | idat.treat$treat == 'TS-TSB-4' & idat.treat$rep == '1' | idat.treat$treat == 'TH' & idat.treat$rep == '1' | idat.treat$treat == 'Un12' & idat.treat$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
idat.treat$new.ID.f <- factor(idat.treat$new.ID, levels = c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'))
ggplot(idat.treat[idat.treat$treat == 'A' & idat.treat$rep == '1' | idat.treat$treat == '2-pos' & idat.treat$rep == '1' | idat.treat$treat == 'TS-TSB-4' & idat.treat$rep == '1' | idat.treat$treat == 'TH' & idat.treat$rep == '1' | idat.treat$treat == 'Un12' & idat.treat$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat.treat[idat.treat$treat == 'A' & idat.treat$rep == '1' | idat.treat$treat == '2-pos' & idat.treat$rep == '1' | idat.treat$treat == 'TS-TSB-4' & idat.treat$rep == '1' | idat.treat$treat == 'TH' & idat.treat$rep == '1' | idat.treat$treat == 'Un12' & idat.treat$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID.d, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat.treat[idat.treat$treat == 'A' & idat.treat$rep == '1' | idat.treat$treat == '2-pos' & idat.treat$rep == '1' | idat.treat$treat == 'TS-TSB-4' & idat.treat$rep == '1' | idat.treat$treat == 'TH' & idat.treat$rep == '1' | idat.treat$treat == 'Un12' & idat.treat$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID.f, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/temp.treat', height = 10, width = 10)
ggplot(idat.treat[idat.treat$new.ID == '13' | idat.treat$new.ID == '14', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID.f, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat.treat[idat.treat$new.ID == '13' | idat.treat$new.ID == '14', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat[idat$new.ID == '13' | idat$new.ID == '14', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat[idat$new.ID == '13' & idat$rep == '1' | idat$new.ID == '14' & idat$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat[idat$new.ID == '13' & idat$treat == 'Un12' & idat$rep == '1' | idat$new.ID == '14' & idat$treat == 'Un12' & idat$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/temp.treat.speed', height = 4, width = 5)
ggsave2x('../plots-meas/temp.treat.speed', height = 3, width = 4)
ggplot(idat.treat[idat.treat$treat == 'A' & idat.treat$rep == '1' | idat.treat$treat == '2-pos' & idat.treat$rep == '1' | idat.treat$treat == 'TS-TSB-4' & idat.treat$rep == '1' | idat.treat$treat == 'TH' & idat.treat$rep == '1' | idat.treat$treat == 'Un12' & idat.treat$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID.f, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/temp.treat', height = 10, width = 8)
ggplot(idat[idat$new.ID == '15' & idat$treat == '2-pos' & idat$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/temp.treat.DFCmov', height = 3, width = 4)
ggsave2x('../plots-meas/temp.treat.DFCmov', height = 3, width = 2.5)
ggplot(idat.prop[idat.prop$treat == 'A' & idat.prop$rep == '1' | idat.prop$treat == '2-pos' & idat.prop$rep == '1' | idat.prop$treat == 'TS-TSB-4' & idat.prop$rep == '1' | idat.prop$treat == 'TH' & idat.prop$rep == '1' | idat.prop$treat == 'Un12' & idat.prop$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(idat.prop[idat.prop$treat == 'A' & idat.prop$rep == '1' | idat.prop$treat == '2-pos' & idat.prop$rep == '1' | idat.prop$treat == 'TS-TSB-4' & idat.prop$rep == '1' | idat.prop$treat == 'TH' & idat.prop$rep == '1' | idat.prop$treat == 'Un12' & idat.prop$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
facet_wrap(~ new.ID, scales = 'free_x') +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/temp.prop', height = 7, width = 8)
# cumulative emission
ggplot(isumm, aes(treat, e.rel.150, color = treat)) +
geom_point() +
facet_wrap(~ trial, scales = 'free_x') +
theme_bw() +
labs(y = 'Loss (% of TAN) h') +
theme(legend.title = element_blank()) +
geom_boxplot(data = esumm, aes(x = treat, y = e.rel.150, color = treat), show.legend = FALSE)
fsumm.prop <- fsumm[is.element(fsumm$trial, c('23H', '23I', '24E', '24F', '24G')), ]
ggplot(fsumm.prop, aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID, ncol = 5) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(fsumm[fsumm$new.ID == '15', ], aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(fsumm[fsumm$new.ID == '15', ], aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 50)
ggplot(fsumm[fsumm$new.ID == '15', ], aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.DFCmov', height = 4, width = 8)
ggsave2x('../plots-meas/NH3.flux.prop', height = 3, width = 2.5)
ggplot(fsumm[fsumm$new.ID == '15', ], aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.DFCmov', height = 4, width = 8)
ggplot(fsumm[fsumm$new.ID == '15', ], aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.DFCmov', height = 3, width = 2.5)
ggplot(fsumm[fsumm$new.ID == '15', ], aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.DFCmov', height = 3, width = 4)
ggplot(fsumm[fsumm$new.ID == '15', ], aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.2) + geom_line() +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.DFCmov', height = 3, width = 4)
ggplot(fsumm[fsumm$new.ID == '15', ], aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.DFCmov', height = 3, width = 4)
ggplot(idat[idat$new.ID == '15' & idat$treat == '2-pos' & idat$rep == '1', ],
aes(cta, air.temp, group = pmid)) +
geom_line() +
theme_bw() +
labs(x = 'Time after application (h)', y = 'Air temperature (°C)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/temp.treat.DFCmov', height = 3, width = 2.5)
