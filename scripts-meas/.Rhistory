app.mthd = 'bc',
man.dm = rnorm(100, mean = 8, sd = 2),
36
air.temp = 20, wind.2m = 3)
datuc1 <- data.frame(group = 1:100, ctime = 168, TAN.app = 50,
app.mthd = 'bc',
man.dm = rnorm(100, mean = 8, sd = 2),
air.temp = 20, wind.2m = 3)
quantile(datuc1$man.dm)
preduc1 <- alfam2(datuc1, pars = alfam2pars03_alpha,
app.name = 'TAN.app', time.name = 'ctime',
group = 'group', conf.int = 'all',
pars.ci = alfam2pars03var_alpha)
head(preduc1)
quantile(preduc1$er, c(0.05, 0.95))
datuc2 <- data.frame(group = 1, ctime = 168, TAN.app = 50,
app.mthd = 'bc',
man.dm = 8,
air.temp = 20, wind.2m = 3)
preduc2 <- alfam2(datuc2, pars = alfam2pars03_alpha, app.name = 'TAN.app',
time.name = 'ctime', group = 'group',
conf.int = 0.9, pars.ci = alfam2pars03var_alpha)
preduc2
dat6b <- dat6
dat6b[3, 'wind.2m'] <- NA
dat6 <- data.frame(scenario = 1:6, ctime = 168, TAN.app = 100,
man.dm = 5, man.ph = 7.2, air.temp = 10,
wind.2m = 2,
man.source = c(rep('Cattle', 2), rep('Pig', 4)),
app.mthd = rep(c('Broadcast', 'Trailing hose'),
each = 3),
incorp = rep(c('None', 'Shallow', 'Deep'), 2),
t.incorp = 4)
dat6b <- dat6
dat6b[3, 'wind.2m'] <- NA
alfam2(dat6b, app.name = "TAN.app", time.name = "ctime",
time.incorp = "t.incorp", group = "scenario",
check = TRUE, warn = FALSE)
dat7 <- data.frame(ctime = 1:10, TAN.app = 100)
pred0 <- alfam2(dat7, app.name = "TAN.app", time.name = "ctime")
pred0 <- alfam2(dat6, pars = c(int.f0 = -1, int.r1 = 0), app.name = "TAN.app",
time.name = "ctime", time.incorp = "t.incorp",
group = "scenario")
alfam2(dat6, app.name = "TAN.app", time.name = "ctim",
time.incorp = TRUE, group = "scenario")
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(alfam2)
vignette('ALFAM2-start')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
library(alfam2)
library(alfam2)
library(alfam2)
library(ALFAM2)
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
vignette('ALFAM2-start')
pred1
version(ALFAM2)
packageVersion(ALFAM2)
packageVersion('ALFAM2')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8,
air.temp = 40, wind.2m = 3,
app.mthd = 'bc')
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
library(data.table)
remove.packages('ALFAM2'); devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(ALFAM2)
vignette('ALFAM2-start')
packageVersion('ALFAM2')
library(ALFAM2)
vignette('ALFAM2-start')
packageVersion('ALFAM2')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8,
air.temp = 40, wind.2m = 3,
app.mthd = 'bc')
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
vignette('ALFAM2-start')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
vignette('ALFAM2-start')
library(ALFAM2)
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(ALFAM2)
vignette('ALFAM2-start')
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(ALFAM2)
vignette('ALFAM2-start')
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
1library(ALFAM2)
library(ALFAM2)
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 100, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 200, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 10, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 10, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 100, man.dm = 8,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 1, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 100, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(ALFAM2)
dat1 <- data.frame(ctime = 168, TAN.app = 100, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 10, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat1, group = scenario, app.name = 'TAN.app', time.name = 'ctime')
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'os')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bc')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
?check
debug(checkDum)
checkDum <- function(dat, vnames = c('^app\\.mthd\\.[ocbt]', '^incorp\\.[ds]', '^man\\.source\\.[cp]')) {
for (i in vnames) {
if (any(grepl(i, names(dat)))) {
dd <- dat[, grepl(i, names(dat)), drop = FALSE]
if (any(dd > 0)) {
rs <- rowSums(dd)
if (any(rs > 1)) {
return(1)
}
}
}
}
return(0)
}
debug(checkDum)
?check
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
1library(ALFAM2)
vignette('ALFAM2-start')
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
library(ALFAM2)
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = c(10, 100), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'bs')
dat1
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
check()
devtools()
library(devtools)
check()
check(alfam2)
.libPaths()
remove.packages('ALFAM2')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev', build_vignettes = TRUE)
library(ALFAM2)
dat
dat1 <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat1
dat <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
names(dat)
c('app.mthd.os', 'app.mthd.cs') %in% names(dat)
any(c('app.mthd.os', 'app.mthd.cs') %in% names(dat))
'app.rate.ni' %in% names(dat)
any(dat[, grepl('app.mthd.[oc]s', names(dat))] == 1)
dat
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
library(ALFAM2)
dat <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat
pred1 <- alfam2(dat1, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(scenario = c(1, 2), ctime = 168, TAN.app = 40, app.rate = c(0, 50), man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = 'cs')
dat
pred1 <- alfam2(dat, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(scenario = c(1, 2, 3), ctime = 168, TAN.app = 40, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
library(ALFAM2)
dat <- data.frame(scenario = c(1, 2, 3), ctime = 168, TAN.app = 40, man.dm = 3,
air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(scenario = c(1, 2, 3), ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(ctime = 168, TAN.app = 40, group = 'app.mthd',
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'scenario', app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime')
pred1
dat <- data.frame(ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime')
pred1
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
vignette('ALFAM2-start')
vignette('ALFAM2-start')
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', app.rate = 'app.rate', time.name = 'ctime', check = TRUE)
dat <- data.frame(ctime = 168, TAN.app = 40, app.rate = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', app.rate = 'app.rate', time.name = 'ctime', check = TRUE)
pred1
dat <- data.frame(ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
dat <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3
app.mthd = c('bc', 'os', 'cs'))
dat <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
dat <- data.frame(ctime = 168, TAN.app = 50,
app.mthd = c('bc', 'os', 'cs'))
dat
pred1 <- alfam2(dat, pars = alfam2pars02, group = 'app.mthd', app.name = 'TAN.app', time.name = 'ctime', check = TRUE)
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 50,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 40,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 60,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 100,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
dat1 <- data.frame(ctime = 168, TAN.app = 60,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
remove.packages('ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
library(ALFAM2)
version(alfam2)
packageVersion(alfam2)
packageVersion(ALFAM2)
library(ALFAM2)
packageVersion(ALFAM2)
packageVersion(ALFAM2.R)
packageVersion(ALFAM2)
?alfam2
dat1 <- data.frame(ctime = 168, TAN.app = 60,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
> alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', g
alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', g
roup = 'app.mthd')
alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'))
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
dat1 <- data.frame(ctime = 168, TAN.app = 50, man.dm = 8, air.temp = 20, wind.2m = 3,
app.mthd = c('bc', 'os', 'cs'), check = FALSE)
dat1
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
pred1 <- alfam2(dat1, pars = alfam2pars02, app.name = 'TAN.app', time.name = 'ctime', group = 'app.mthd')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2')
# devtools::install_github('AU-BCE-EE/ALFAM2', ref = 'dev')
devtools::install_github('AU-BCE-EE/ALFAM2', force = TRUE)
args(ALFAM2)
library(ALFAM2)
args(ALFAM2)
library(ALFAM2)
library(ALFAM2)
args(ALFAM2)
args(alfam)
args(alfam2)
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Pedersen-2024-MAG/scripts-meas")
rm(list = ls())
source('functions.R')
source('packages.R')
source('load.R')
source('subset.R')
source('summary.R')
source('export.R')
# dividing dataframe into treat and prop and adding trial ID's
idat.treat <- idat[is.element(idat$exper, c('23C', '23D', '23G', '24M', '24B', '24C', '24D', '24H', '24J', '24L', '24N', '24O')), ]
idat.prop <- idat[is.element(idat$exper, c('23H', '23I', '24E', '24F', '24G')), ]
fsumm$treat1 <- fsumm$treat
fsumm$treat1 <- gsub('A acid', 'A Acid', fsumm$treat1)
fsumm$treat1 <- gsub('A dec', 'A Sep-D', fsumm$treat1)
fsumm$treat1 <- gsub('A dec acid', 'A Sep-D + acid', fsumm$treat1)
fsumm$treat1 <- gsub('A dis', 'A Dis', fsumm$treat1)
fsumm$treat1 <- gsub('A dis acid', 'A Dis + acid', fsumm$treat1)
fsumm$treat1 <- gsub('A screw', 'A Sep-S', fsumm$treat1)
fsumm$treat1 <- gsub('B acid', 'B Acid', fsumm$treat1)
fsumm$treat1 <- gsub('B screw', 'B Sep-S', fsumm$treat1)
fsumm$treat1 <- gsub('B screw acid', 'B Sep-S + acid', fsumm$treat1)
fsumm$treat1 <- gsub('C dec', 'C Sep-D', fsumm$treat1)
fsumm$treat1 <- gsub('TH-12', 'TH', fsumm$treat1)
fsumm$treat1 <- gsub('TS-TSB-12', 'TS1', fsumm$treat1)
fsumm$treat1 <- gsub('TS-Bo', 'TS2', fsumm$treat1)
fsumm$treat1 <- gsub('TS-TSB+', 'TS3', fsumm$treat1)
fsumm$treat1 <- gsub('TS-TSB', 'TS1', fsumm$treat1)
fsumm.treat <- fsumm[is.element(fsumm$trial, c('23C', '23D', '23G', '24M', '24B', '24C', '24D', '24H', '24J', '24L', '24N', '24O')), ]
ggplot(fsumm[fsumm$new.ID == '15', ], aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(fsumm[fsumm$new.ID == '9' | fsumm$new.DK == '10', ],
aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggplot(fsumm[fsumm$new.ID == '9' | fsumm$new.ID == '10', ],
aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
fsumm$new.ID.f <- factor(fsumm$new.ID, levels = c('9', '10'))
ggplot(fsumm[fsumm$new.ID == '9' | fsumm$new.ID == '10', ],
aes(cta, j.rel.mn, color = treat, fill = treat)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.speed', height = 3, width = 7)
fsumm$treat1 <- gsub('TS-TSB-12', 'TS-12', fsumm$treat1)
fsumm$treat1 <- gsub('TS-TSB-12', 'TS-12', fsumm$treat1)
fsumm$treat1 <- gsub('TS-TSB-4', 'TS-4', fsumm$treat1)
fsumm$new.ID.f <- factor(fsumm$new.ID, levels = c('9', '10'))
ggplot(fsumm[fsumm$new.ID == '9' | fsumm$new.ID == '10', ],
aes(cta, j.rel.mn, color = treat1, fill = treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
fsumm$treat2 <- fsumm$treat
fsumm$treat2 <- fsumm$treat
fsumm$treat2 <- gsub('TS-TSB-12', 'TS-12', fsumm$treat2)
fsumm$treat2 <- gsub('TS-TSB-4', 'TS-4', fsumm$treat2)
fsumm$new.ID.f <- factor(fsumm$new.ID, levels = c('9', '10'))
ggplot(fsumm[fsumm$new.ID == '9' | fsumm$new.ID == '10', ],
aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', h^-1,')'))) + xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 150)
ggsave2x('../plots-meas/NH3.flux.speed', height = 3, width = 7)
