# reduction vs absolute emission, shows that the negative reductions are with low emissions
ggplot(dw, aes(NH3loss_ref, rdNH3, color = FertiliserType)) +
geom_point()
ggplot(dw, aes(interact, rdNH3, color = FertiliserType)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3, symbol = FertiliserType, color = Clay)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
df$FertiliserType <- gsub('zUrea', 'Urea', df$FertiliserType)
# Long data frame for use below
dl <- melt(df, id.vars = c('Ref', 'set', 'Application', 'id', 'FertiliserType', 'Depth', 'Clay'),
measure.vars = c('NH3loss'), na.rm = TRUE)
# Spread out ref and treat
dw <- dcast(dl, Ref + set + FertiliserType + Depth ~ variable + id, value.var = 'value')
# Relative reduction in NH3 due to incorporation
dw[, rdNH3 := 100 * (1 - NH3loss_treat/ NH3loss_ref)]
# dividing depth into categories
table(dw$Depth, dw$FertiliserType)
dw$DepthCat <- 'Unknown'
dw[dw$Depth >= 1 & dw$Depth <= 5, ]$DepthCat <- '1 - >5'
dw[dw$Depth > 5 & dw$Depth <= 10, ]$DepthCat <- '5 - 10'
# total avg and sd reduction (%)
avgRd <- mean(dw$rdNH3)
sdRd <- sd(dw$rdNH3)
# df for arrow plot
du <- full_join(dl, dw[, c('Ref', 'set', 'rdNH3')], by = c('Ref', 'set'))
dw$interact <- factor(interaction(dw$FertiliserType, dw$DepthCat, sep = ' '),
levels = c('AS Unknown', 'Urea Unknown', 'AS 1 - >5', 'Urea 1 - >5', 'AS 5 - 10', 'Urea 5 - 10'))
ggplot(dw, aes(interact, rdNH3, symbol = FertiliserType, color = Clay)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
df$FertiliserType <- gsub('zUrea', 'Urea', df$FertiliserType)
# Long data frame for use below
dl <- melt(df, id.vars = c('Ref', 'set', 'Application', 'id', 'FertiliserType', 'Depth', 'Clay'),
measure.vars = c('NH3loss'), na.rm = TRUE)
# Spread out ref and treat
dw <- dcast(dl, Ref + set + FertiliserType + Depth + Clay ~ variable + id, value.var = 'value')
# Relative reduction in NH3 due to incorporation
dw[, rdNH3 := 100 * (1 - NH3loss_treat/ NH3loss_ref)]
# dividing depth into categories
table(dw$Depth, dw$FertiliserType)
dw$DepthCat <- 'Unknown'
dw[dw$Depth >= 1 & dw$Depth <= 5, ]$DepthCat <- '1 - >5'
dw[dw$Depth > 5 & dw$Depth <= 10, ]$DepthCat <- '5 - 10'
# total avg and sd reduction (%)
avgRd <- mean(dw$rdNH3)
sdRd <- sd(dw$rdNH3)
# df for arrow plot
du <- full_join(dl, dw[, c('Ref', 'set', 'rdNH3')], by = c('Ref', 'set'))
dw$interact <- factor(interaction(dw$FertiliserType, dw$DepthCat, sep = ' '),
levels = c('AS Unknown', 'Urea Unknown', 'AS 1 - >5', 'Urea 1 - >5', 'AS 5 - 10', 'Urea 5 - 10'))
ggplot(dw, aes(interact, rdNH3, symbol = FertiliserType, color = Clay)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
View(dw)
ggplot(dw, aes(interact, rdNH3, symbol = FertiliserType)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35, color = Clay) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
# dividing clay content into categories
table(dw$Clay, dw$FertiliserType)
plot(dw$Clay)
df$FertiliserType <- gsub('zUrea', 'Urea', df$FertiliserType)
# Long data frame for use below
dl <- melt(df, id.vars = c('Ref', 'set', 'Application', 'id', 'FertiliserType', 'Depth', 'Clay'),
measure.vars = c('NH3loss'), na.rm = TRUE)
# Spread out ref and treat
dw <- dcast(dl, Ref + set + FertiliserType + Depth + Clay ~ variable + id, value.var = 'value')
# Relative reduction in NH3 due to incorporation
dw[, rdNH3 := 100 * (1 - NH3loss_treat/ NH3loss_ref)]
# dividing depth into categories
table(dw$Depth, dw$FertiliserType)
dw$DepthCat <- 'Unknown'
dw[dw$Depth >= 1 & dw$Depth <= 5, ]$DepthCat <- '1 - >5'
dw[dw$Depth > 5 & dw$Depth <= 10, ]$DepthCat <- '5 - 10'
# dividing clay content into categories
table(dw$Clay, dw$FertiliserType)
plot(dw$Clay)
dw$Clay <- 'Unknown'
dw[dw$Clay >= 10 & dw$Clay <= 20, ]$ClayCat <- '10 - 20'
dw[dw$Clay >= 20 & dw$Clay <= 40, ]$ClayCat <- '>20 - 40'
dw[dw$Clay >= 40 & dw$Clay <= 70, ]$ClayCat <- '>40 - 70'
# total avg and sd reduction (%)
avgRd <- mean(dw$rdNH3)
sdRd <- sd(dw$rdNH3)
# df for arrow plot
du <- full_join(dl, dw[, c('Ref', 'set', 'rdNH3')], by = c('Ref', 'set'))
dw$interact <- factor(interaction(dw$FertiliserType, dw$DepthCat, sep = ' '),
levels = c('AS Unknown', 'Urea Unknown', 'AS 1 - >5', 'Urea 1 - >5', 'AS 5 - 10', 'Urea 5 - 10'))
ggplot(dw, aes(interact, rdNH3, symbol = FertiliserType), color = ClayCat) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3, symbol = FertiliserType, color = ClayCat)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
rm(list = ls())
source('packages.R')
source('functions.R')
source('load.R')
source('summ.R')
rm(list = ls())
source('packages.R')
source('functions.R')
source('load.R')
df$FertiliserType <- gsub('zUrea', 'Urea', df$FertiliserType)
# Long data frame for use below
dl <- melt(df, id.vars = c('Ref', 'set', 'Application', 'id', 'FertiliserType', 'Depth', 'Clay'),
measure.vars = c('NH3loss'), na.rm = TRUE)
# Spread out ref and treat
dw <- dcast(dl, Ref + set + FertiliserType + Depth + Clay ~ variable + id, value.var = 'value')
# Relative reduction in NH3 due to incorporation
dw[, rdNH3 := 100 * (1 - NH3loss_treat/ NH3loss_ref)]
# dividing depth into categories
table(dw$Depth, dw$FertiliserType)
dw$DepthCat <- 'Unknown'
dw[dw$Depth >= 1 & dw$Depth <= 5, ]$DepthCat <- '1 - >5'
dw[dw$Depth > 5 & dw$Depth <= 10, ]$DepthCat <- '5 - 10'
# dividing clay content into categories
table(dw$Clay, dw$FertiliserType)
plot(dw$Clay)
dw$Clay <- 'Unknown'
dw$ClayCat <- 'Unknown'
dw[dw$ClayCat >= 10 & dw$ClayCat <= 20, ]$ClayCat <- '10 - >20'
dw[dw$ClayCat >= 20 & dw$ClayCat <= 40, ]$ClayCat <- '20 - >40'
dw[dw$ClayCat >= 40 & dw$ClayCat <= 70, ]$ClayCat <- '>40 - >70'
# total avg and sd reduction (%)
avgRd <- mean(dw$rdNH3)
sdRd <- sd(dw$rdNH3)
# df for arrow plot
du <- full_join(dl, dw[, c('Ref', 'set', 'rdNH3')], by = c('Ref', 'set'))
dw$interact <- factor(interaction(dw$FertiliserType, dw$DepthCat, sep = ' '),
levels = c('AS Unknown', 'Urea Unknown', 'AS 1 - >5', 'Urea 1 - >5', 'AS 5 - 10', 'Urea 5 - 10'))
ggplot(dw, aes(interact, rdNH3, symbol = FertiliserType, color = ClayCat)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
View(dw)
rm(list = ls())
source('packages.R')
source('functions.R')
source('load.R')
source('summ.R')
dw$interact <- factor(interaction(dw$FertiliserType, dw$DepthCat, sep = ' '),
levels = c('AS Unknown', 'Urea Unknown', 'AS 1 - >5', 'Urea 1 - >5', 'AS 5 - 10', 'Urea 5 - 10'))
ggplot(dw, aes(interact, rdNH3, symbol = FertiliserType, color = ClayCat)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
rm(list = ls())
source('packages.R')
source('functions.R')
source('load.R')
df$FertiliserType <- gsub('zUrea', 'Urea', df$FertiliserType)
# Long data frame for use below
dl <- melt(df, id.vars = c('Ref', 'set', 'Application', 'id', 'FertiliserType', 'Depth', 'Clay'),
measure.vars = c('NH3loss'), na.rm = TRUE)
# Spread out ref and treat
dw <- dcast(dl, Ref + set + FertiliserType + Depth + Clay ~ variable + id, value.var = 'value')
# Relative reduction in NH3 due to incorporation
dw[, rdNH3 := 100 * (1 - NH3loss_treat/ NH3loss_ref)]
# dividing depth into categories
table(dw$Depth, dw$FertiliserType)
dw$DepthCat <- 'Unknown'
dw[dw$Depth >= 1 & dw$Depth <= 5, ]$DepthCat <- '1 - >5'
dw[dw$Depth > 5 & dw$Depth <= 10, ]$DepthCat <- '5 - 10'
# dividing clay content into categories
table(dw$Clay, dw$FertiliserType)
plot(dw$Clay)
dw$ClayCat <- 'Unknown'
dw[dw$Clay >= 10 & dw$Clay <= 20, ]$ClayCat <- '10 - >20'
dw[dw$Clay >= 20 & dw$Clay <= 40, ]$ClayCat <- '20 - >40'
dw[dw$Clay >= 40 & dw$Clay <= 70, ]$ClayCat <- '>40 - >70'
# total avg and sd reduction (%)
avgRd <- mean(dw$rdNH3)
sdRd <- sd(dw$rdNH3)
# df for arrow plot
du <- full_join(dl, dw[, c('Ref', 'set', 'rdNH3')], by = c('Ref', 'set'))
dw$interact <- factor(interaction(dw$FertiliserType, dw$DepthCat, sep = ' '),
levels = c('AS Unknown', 'Urea Unknown', 'AS 1 - >5', 'Urea 1 - >5', 'AS 5 - 10', 'Urea 5 - 10'))
ggplot(dw, aes(interact, rdNH3, symbol = FertiliserType, color = ClayCat)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
rm(list = ls())
source('packages.R')
source('functions.R')
source('load.R')
source('summ.R')
dw$interact <- factor(interaction(dw$FertiliserType, dw$DepthCat, sep = ' '),
levels = c('AS Unknown', 'Urea Unknown', 'AS 1 - >5', 'Urea 1 - >5', 'AS 5 - 10', 'Urea 5 - 10'))
ggplot(dw, aes(interact, rdNH3, symbol = FertiliserType)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(aes(color = ClayCat), outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(aes(color = ClayCat), outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3)) +
#  annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
#            alpha = 0.2, fill = '#7570b3') +
geom_boxplot(aes(color = ClayCat), outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3)) +
#  annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
#            alpha = 0.2, fill = '#7570b3') +
geom_boxplot(aes(color = ClayCat), outlier.alpha = 0) +
theme_bw() +
#  geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3)) +
#  annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
#            alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3)) +
#  annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
#            alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(aes(color = ClayCat), width = 0.1, alpha = 0.35) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3)) +
#  annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
#            alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(aes(color = ClayCat), width = 0.1, alpha = 0.5) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.2, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(aes(color = ClayCat), width = 0.1, alpha = 0.5) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.1, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(aes(color = ClayCat), width = 0.1, alpha = 0.5) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.1, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(aes(color = ClayCat), width = 0.1, alpha = 1) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
ggplot(dw, aes(interact, rdNH3)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.1, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(aes(color = ClayCat), width = 0.1, alpha = 0.8) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/AU-MHB-internal/2024_3.42PA_NH3urea/incorp and injec/scripts")
rm(list = ls())
source('packages.R')
source('functions.R')
source('load.R')
source('summ.R')
dw$interact <- factor(interaction(dw$FertiliserType, dw$DepthCat, sep = ' '),
levels = c('AS Unknown', 'Urea Unknown', 'AS 1 - >5', 'Urea 1 - >5', 'AS 5 - 10', 'Urea 5 - 10'))
ggplot(dw, aes(interact, rdNH3)) +
annotate('rect', xmin = 0, xmax = 6.5, ymin = avgRd - sdRd, ymax = avgRd + sdRd,
alpha = 0.1, fill = '#7570b3') +
geom_boxplot(outlier.alpha = 0) +
theme_bw() +
geom_jitter(aes(color = ClayCat), width = 0.1, alpha = 0.8) +
ylab('Emission reduction (% reference)') + xlab(NULL) +
scale_x_discrete(labels = c('Unknown', 'Unknown', '1 to >5 cm', '1 to >5 cm', '5 to 10 cm', '5 to 10 cm')) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_hline(yintercept = avgRd, color = '#7570b3') +
scale_color_brewer(palette = "Dark2")
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Pedersen-2024-MAG/scripts-meas")
rm(list = ls())
source('functions.R')
source('packages.R')
source('load.R')
source('subset.R')
source('summary.R')
source('stats.R')
source('export.R')
idat.treat <- idat[is.element(idat$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
idat.prop <- idat[is.element(idat$new.ID, c('D1', 'D2', 'D3', 'D4', 'D5')), ]
fsumm.treat <- fsumm[is.element(fsumm$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
# Flux plot for 'Oversigt over landsforsøg', send to Torben Frandsen in november 2024
dfTF <- fsumm[fsumm$new.ID == '11' | fsumm$new.ID == '12', ]
dfTF$new.IDv2 <- dfTF$new.ID
dfTF$new.IDv2 <- gsub('11', 'Forsøg 1', dfTF$new.IDv2)
dfTF$new.IDv2 <- gsub('12', 'Forsøg 2', dfTF$new.IDv2)
IDs <- c(`TH` =  'Slæbeslange',
`TS1` =  'Slæbesko',
`TS1 + acid` =  'Slæbesko + syre',
`OSI` =  'Åben rende nedfældning')
dfTF[, new.treat1 := IDs[treat1]]
dfTF <- dfTF[! c(dfTF$new.ID == '11' & dfTF$treat1 == 'TS1 + acid'), ]
dfTF$new.ID.f <- factor(dfTF$new.IDv2, levels = c('Forsøg 1', 'Forsøg 2'))
ggplot(dfTF, aes(cta, j.rel.mn, color = new.treat1, fill = new.treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f, scales = 'free') +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn + j.rel.sd, ymin = j.rel.mn - j.rel.sd, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (frak. TAN  ', time^-1,')'))) + xlab('Tid efter udbringing (timer)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 40)
dfTF$j.rel.mn1 <- dfTF$j.rel.mn * 100
dfTF$j.rel.sd1 <- dfTF$j.rel.sd * 100
ggplot(dfTF, aes(cta, j.rel.mn1, color = new.treat1, fill = new.treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn1 + j.rel.sd1, ymin = j.rel.mn1 - j.rel.sd1, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', time^-1,')'))) + xlab('Tid efter udbringing (timer)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 40)
ggplot(dfTF, aes(cta, j.rel.mn1, color = new.treat1, fill = new.treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn1 + j.rel.sd1, ymin = j.rel.mn1 - j.rel.sd1, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', time^-1,')'))) + xlab('Tid efter udbringing (timer)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_text(aes(decimal.mark = ','))
ggplot(dfTF, aes(cta, j.rel.mn1, color = new.treat1, fill = new.treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn1 + j.rel.sd1, ymin = j.rel.mn1 - j.rel.sd1, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', time^-1,')'))) + xlab('Tid efter udbringing (timer)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_text(aes(decimal.mark = ',')) +
xlim(NA, 40)
ggplot(dfTF, aes(cta, j.rel.mn1, color = new.treat1, fill = new.treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn1 + j.rel.sd1, ymin = j.rel.mn1 - j.rel.sd1, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', time^-1,')'))) + xlab('Tid efter udbringing (timer)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
geom_text(aes(decimal.mark = ',')) +
xlim(NA, 40)
ggplot(dfTF, aes(cta, j.rel.mn1, color = new.treat1, fill = new.treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn1 + j.rel.sd1, ymin = j.rel.mn1 - j.rel.sd1, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', time^-1,')'))) + xlab('Tid efter udbringing (timer)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
scale_y_continuous(breaks=seq(0, .1, by = .02), labels = gsub("\\.", ",", seq(0, .1, by = .02))) +
xlim(NA, 40)
ggplot(dfTF, aes(cta, j.rel.mn1, color = new.treat1, fill = new.treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn1 + j.rel.sd1, ymin = j.rel.mn1 - j.rel.sd1, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', time^-1,')'))) + xlab('Tid efter udbringing (timer)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
scale_y_continuous(breaks=seq(0, 10, by = 2), labels = gsub("\\.", ",", seq(0, 10, by = 2))) +
xlim(NA, 40)
ggplot(dfTF, aes(cta, j.rel.mn1, color = new.treat1, fill = new.treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn1 + j.rel.sd1, ymin = j.rel.mn1 - j.rel.sd1, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', time^-1,')'))) + xlab('Tid efter udbringing (timer)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
#  scale_y_continuous(breaks=seq(0, 10, by = 2), labels = gsub("\\.", ",", seq(0, 10, by = 2))) +
xlim(NA, 40)
dfTF$new.ID.f <- factor(dfTF$new.IDv2, levels = c('Forsøg 1', 'Forsøg 2'))
ggplot(dfTF, aes(cta, j.rel.mn1, color = new.treat1, fill = new.treat1)) +
geom_point(shape = 1, size = 0.5) + geom_line() +
facet_wrap(~ new.ID.f) +
theme_bw() +
geom_ribbon(aes (ymax = j.rel.mn1 + j.rel.sd1, ymin = j.rel.mn1 - j.rel.sd1, group = treat1), alpha = 0.3, color = NA) +
ylab(expression(paste('Flux (% TAN  ', time^-1,')'))) + xlab('Tid efter udbringing (timer)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 40)
ggsave2x('../plots-meas/NH3.flux.11and12', height = 4, width = 6)
