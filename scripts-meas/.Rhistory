rm(list = ls())
# Set release tag for download
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/'
rtag <- 'v2.22'
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Pedersen-2024-MAG/scripts")
rm(list = ls())
# Set release tag for download
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/'
rtag <- 'v2.22'
library(data.table)
sink('../logs/versions.txt')
print(sessionInfo())
sink()
??sink
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
install.packages(R.utils)
install.packages("R.utils")
library(data.table)
library(R.utils)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
View(idat)
pdat <- fread(paste0(p, '/data-output/03/ALFAM2_plot.csv.gz'))
# Get file with data version number
download.file(paste0(p, '/data-output/03/data_version.txt'), destfile = '../logs/data_version.txt')
pdat$app.date <- as.character(pdat$app.start, format = '%Y-%m-%d')
pdat <- subset(pdat, proj == 'eGylle' & app.date %in% c('2021-08-11', '2021-08-20', '2022-01-05') & meas.tech != 'DTM' & is.na(meas.tech.det))
# Drop non-eGylle obs from emis interval data
idat <- subset(idat, pmid %in% unique(pdat$pmid))
pdat <- subset(pdat, proj == 'eGylle' & app.date %in% c('2021-08-11', '2021-08-20', '2022-01-05') & meas.tech != 'DTM' & is.na(meas.tech.det))
# Download latest ALFAM2 data, subset to this study, and save copy
rm(list = ls())
# Set release tag for download
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/'
rtag <- 'v2.22'
# Alternative below to get particular commit (if not yet in release)
#ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/bf608a10d324444627acf35f0aadeaced5f008c9/'
#rtag <- ''
source('packages.R')
source('load.R')
rm(list = ls())
# Set release tag for download
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/'
rtag <- 'v2.22'
source('packages.R')
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
pdat <- fread(paste0(p, '/data-output/03/ALFAM2_plot.csv.gz'))
# Get file with data version number
download.file(paste0(p, '/data-output/03/data_version.txt'), destfile = '../logs/data_version.txt')
pdat$app.date <- as.character(pdat$app.start, format = '%Y-%m-%d')
View(pdat)
pdat <- subset(pdat, proj == 'MAG')
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Pedersen-2024-MAG/scripts")
rm(list = ls())
# Set release tag for download
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/'
rtag <- 'v2.23'
source('packages.R')
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
pdat <- fread(paste0(p, '/data-output/03/ALFAM2_plot.csv.gz'))
# Get file with data version number
download.file(paste0(p, '/data-output/03/data_version.txt'), destfile = '../logs/data_version.txt')
pdat$app.date <- as.character(pdat$app.start, format = '%Y-%m-%d')
pdat <- subset(pdat, proj == 'MAG')
source('packages.R')
source('load.R')
pdat <- subset(pdat, proj == 'eGylle')
View(pdat)
source('packages.R')
source('load.R')
pdat <- subset(pdat, proj == 'MAG')
View(idat)
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
pdat <- fread(paste0(p, '/data-output/03/ALFAM2_plot.csv.gz'))
# Get file with data version number
download.file(paste0(p, '/data-output/03/data_version.txt'), destfile = '../logs/data_version.txt')
View(pdat)
rm(list = ls())
# Set release tag for download
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/'
rtag <- 'v2.32'
source('packages.R')
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
# Get file with data version number
download.file(paste0(p, '/data-output/03/data_version.txt'), destfile = '../logs/data_version.txt')
# Alternative below to get particular commit (if not yet in release)
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/commit/91bb37fb91867dd62434aafc681f5f8f71b5b73d'
rtag <- ''
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
pdat <- fread(paste0(p, '/data-output/03/ALFAM2_plot.csv.gz'))
# Get file with data version number
download.file(paste0(p, '/data-output/03/data_version.txt'), destfile = '../logs/data_version.txt')
View(idat)
# Alternative below to get particular commit (if not yet in release)
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/commit/91bb37fb91867dd62434aafc681f5f8f71b5b73d'
rtag <- ''
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
p <- paste0(ghpath, rtag)
p
# Alternative below to get particular commit (if not yet in release)
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/commit/91bb37fb91867dd62434aafc681f5f8f71b5b73d'
rtag <- '2.32'
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
# Alternative below to get particular commit (if not yet in release)
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/commit/91bb37fb91867dd62434aafc681f5f8f71b5b73d/'
rtag <- '2.32'
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
# Alternative below to get particular commit (if not yet in release)
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/91bb37fb91867dd62434aafc681f5f8f71b5b73d/'
rtag <- '2.32'
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
rm(list = ls())
source('packages.R')
# Alternative below to get particular commit (if not yet in release)
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/91bb37fb91867dd62434aafc681f5f8f71b5b73d/'
rtag <- '2.32'
p <- paste0(ghpath, rtag)
# Alternative below to get particular commit (if not yet in release)
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/91bb37fb91867dd62434aafc681f5f8f71b5b73d/'
rtag <- ' '
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
# Alternative below to get particular commit (if not yet in release)
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/blob/master/data-submitted/03/AU/ALFAM2_template_7.0_MAGspring23_231117.xlsx'
rtag <- ' '
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
pdat <- fread(paste0(p, '/data-output/03/ALFAM2_plot.csv.gz'))
# Get file with data version number
download.file(paste0(p, '/data-output/03/data_version.txt'), destfile = '../logs/data_version.txt')
rm(list = ls())
source('packages.R')
# Alternative below to get particular commit (if not yet in release)
ghpath <- 'data-submitted/03/AU/ALFAM2_template_7.0_MAGspring23_231117.xlsx'
rtag <- ' '
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
# Download latest ALFAM2 data, subset to this study, and save copy
rm(list = ls())
source('packages.R')
# Alternative below to get particular commit (if not yet in release)
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/data-submitted/03/AU/ALFAM2_template_7.0_MAGspring23_231117.xlsx'
rtag <- ' '
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
# Alternative below to get particular commit (if not yet in release)
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/91bb37fb91867dd62434aafc681f5f8f71b5b73/'
rtag <- ''
'
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
pdat <- fread(paste0(p, '/data-output/03/ALFAM2_plot.csv.gz'))
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
pdat <- fread(paste0(p, '/data-output/03/ALFAM2_plot.csv.gz'))
View(idat)
View(idat)
View(pdat)
idat <- subset(idat, proj == 'MAG')
idat <- subset(idat, proj = 'MAG')
idat <- data.frame(fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz')))
pdat <- data.frame(fread(paste0(p, '/data-output/03/ALFAM2_plot.csv.gz')))
idat <- subset(idat, proj = 'MAG')
idat <- subset(idat, proj == 'MAG')
names(idat)
pdat <- subset(idat, proj == 'MAG')
pdat <- subset(pdat, proj == 'MAG')
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
pdat <- fread(paste0(p, '/data-output/03/ALFAM2_plot.csv.gz'))
pdat <- subset(pdat, proj == 'MAG')
# Drop non-eGylle obs from emis interval data
idat <- subset(idat, pmid %in% unique(pdat$pmid))
View(pdat)
# Download latest ALFAM2 data, subset to this study, and save copy
rm(list = ls())
source('packages.R')
ghpath <- 'https://github.com/sashahafner/ALFAM2-data/raw/91bb37fb91867dd62434aafc681f5f8f71b5b73/'
rtag <- ''
p <- paste0(ghpath, rtag)
idat <- fread(paste0(p, '/data-output/03/ALFAM2_interval.csv.gz'))
pdat <- fread(paste0(p, '/data-output/03/ALFAM2_plot.csv.gz'))
pdat <- subset(pdat, proj == 'MAG')
# Drop non-eGylle obs from emis interval data
idat <- subset(idat, pmid %in% unique(pdat$pmid))
View(idat)
View(pdat)
pdat <- subset(pdat, exper != c('testA', 'testB', 'testC'))
View(pdat)
pdat <- subset(pdat, exper =! c('testA', 'testB', 'testC'))
pdat <- subset(pdat, ! exper == c('testA', 'testB', 'testC'))
?subset
pdat <- subset(pdat, ! exper == c(testA, testB, testC))
pdat <- subset(pdat, exper != c(testA, testB, testC))
pdat <- subset(pdat, t.start.p > 2023-01-01 00:00:00))
pdat <- subset(pdat, t.start.p > '2023-01-01 00:00:00'))
pdat <- subset(pdat, t.start.p > '2023-01-01 00:00:00')
# Drop non-relevant obs from emis interval data
idat <- subset(idat, pmid %in% unique(pdat$pmid))
rm(list = ls())
source('packages.R')
source('load.R')
source('subset.R')
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Pedersen-2025-MAG/data-emission/scripts")
# Download latest ALFAM2 data, subset to this study, and save copy
rm(list = ls())
source('packages.R')
source('load.R')
View(pdat)
# subsetting data from the MAG project
pdat <- subset(pdat, proj == 'MAG')
# excluding data from fall 2022 where chambers where tested
pdat <- subset(pdat, t.start.p > '2023-01-01 00:00:00')
# Drop non-relevant obs from emis interval data
idat <- subset(idat, pmid %in% unique(pdat$pmid))
View(idat)
View(pdat)
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Pedersen-2025-MAG/scripts-meas")
rm(list = ls())
source('functions.R')
source('packages.R')
source('load.R')
source('subset.R')
source('D3_times.R')
source('summary.R')
#render('stats.Rmd', output_file = '../stats-meas/stats.pdf')
source('export.R')
# dividing dataframe into treat and prop and adding trial ID's
idat.treat <- idat[is.element(idat$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
idat.prop <- idat[is.element(idat$new.ID, c('D1', 'D2', 'D3', 'D4', 'D5')), ]
fsumm.treat <- fsumm[is.element(fsumm$new.ID, c('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12')), ]
# plot for technical note, combining the two above
fsumm1 <- fsumm[fsumm$new.ID == '9' | fsumm$new.ID == '10' | fsumm$new.ID == '15', ]
new.ID2 <- c(`9` =  'Trial 2a',
`10` =  'Trial 2b',
`15` =  'Trial 4')
fsumm1[, new.ID2 := new.ID2[new.ID]]
treat2_labels <- c(
`2-Pos` = '2 positions',
`7-Pos` = '7 positions',
`No` = '1 position',
`TH` = 'TH 12 km^-1',
`TH-4` = 'TH 4 km^-1',
`TS1` = 'TS 12 km^-1',
`TS1-4` = 'TS 4 km^-1'
)
fsumm1[, treat2 := treat2_labels[treat1]]
treat2_expressions <- c(
`2 positions` = expression("2 positions"),
`7 positions` = expression("7 positions"),
`1 position` = expression("1 position"),
`TH 12 km^-1` = expression("TH 12 km"^-1),
`TH 4 km^-1` = expression("TH 4 km"^-1),
`TS 12 km^-1` = expression("TS 12 km"^-1),
`TS 4 km^-1` = expression("TS 4 km"^-1)
)
fsumm1[, treat2 := factor(treat2, levels = c(
'TH 12 km^-1',
'TH 4 km^-1',
'TS 12 km^-1',
'TS 4 km^-1',
'1 position',
'2 positions',
'7 positions'
))]
ggplot(fsumm1, aes(cta, j.rel.mn, color = treat2, fill = treat2)) +
geom_point(size = 0.5) +
geom_line() +
geom_ribbon(aes(
ymax = j.rel.mn + j.rel.sd,
ymin = j.rel.mn - j.rel.sd,
group = treat2
), alpha = 0.3, color = NA) +
facet_wrap(~ new.ID2, scales = 'free_y') +
scale_color_discrete(labels = treat2_expressions) +
scale_fill_discrete(labels = treat2_expressions) +
theme_bw() +
ylab(expression(paste('Flux (frac TAN  ', h^-1,')'))) +
xlab('Time from application (h)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
xlim(NA, 75)
ggsave2x('../plots-meas/tech.note', height = 4, width = 8)
