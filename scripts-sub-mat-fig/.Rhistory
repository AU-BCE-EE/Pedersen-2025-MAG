`D3` =  'Trial 3',
`D4` =  'Trial 4',
`D5` =  'Trial 5')
ds[, trial.ID := IDs[new.ID.x]]
dsd[, trial.ID := IDs[new.ID.x]]
f11 <- ggplot(dsd, aes(area.perc.mn, e.rel.150, color = dig1, shape = new.ID.x)) +
geom_point() +
theme_bw() +
ylab(expression(paste(NH[3],' (% of TAN)'))) + xlab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank())
IDs <- c(`D1` =  'Trial 1',
`D2` =  'Trial 2',
`D3` =  'Trial 3',
`D4` =  'Trial 4',
`D5` =  'Trial 5')
ds[, trial.ID := IDs[new.ID.x]]
dsd[, trial.ID := IDs[new.ID.x]]
f11 <- ggplot(dsd, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
ylab(expression(paste(NH[3],' (% of TAN)'))) + xlab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank())
f22 <- ggplot(dsd, aes(area.perc.mn, TS.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
ylab('Dry matter (%)') + xlab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank())
mat <- matrix(c(1, 2),
nrow = 1)
pf <- grid.arrange(f11, f22, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat1', plot = pf, height = 4, width = 8)
f1 <- ggplot(ds, aes(TS.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank())
f2 <- ggplot(ds, aes(pH.lab.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('pH') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank())
f3 <- ggplot(ds, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Exposed surface area (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank())
f4 <- ggplot(ds, aes(n.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('n') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank())
f5 <- ggplot(ds, aes(TS.mn, area.perc.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank())
f6 <- ggplot(ds, aes(TS.mn, n.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('n') +
theme(legend.position = 'bottom', legend.title = element_blank())
mat <- matrix(c(1, 2,
3, 4,
5, 6),
nrow = 3, byrow = TRUE)
pf <- grid.arrange(f1, f2, f3, f4, f5, f6, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat3', plot = pf, height = 13, width = 8)
ggsave2x('../plots-meas/dig.prop.supMat3', plot = pf, height = 8, width = 7)
ggsave2x('../plots-meas/dig.prop.supMat3', plot = pf, height = 10, width = 7)
f11 <- ggplot(dsd, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
ylab(expression(paste(NH[3],' (% of TAN)'))) + xlab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank())
f22 <- ggplot(dsd, aes(area.perc.mn, TS.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
ylab('Dry matter (%)') + xlab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank())
mat <- matrix(c(1, 2),
nrow = 1)
pf <- grid.arrange(f11, f22, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat1', plot = pf, height = 3, width = 6)
f11 <- ggplot(dsd, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point(color = '#00BA38') +
theme_bw() +
ylab(expression(paste(NH[3],' (% of TAN)'))) + xlab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank())
f22 <- ggplot(dsd, aes(area.perc.mn, TS.mn, color = dig1, shape = trial.ID)) +
geom_point(color = '#00BA38') +
theme_bw() +
ylab('Dry matter (%)') + xlab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank())
mat <- matrix(c(1, 2),
nrow = 1)
pf <- grid.arrange(f11, f22, layout_matrix = mat)
f11 <- ggplot(dsd, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point(color = '#00BA38') +
theme_bw() +
ylab(expression(paste(NH[3],' (% of TAN)'))) + xlab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 2))
f22 <- ggplot(dsd, aes(area.perc.mn, TS.mn, color = dig1, shape = trial.ID)) +
geom_point(color = '#00BA38') +
theme_bw() +
ylab('Dry matter (%)') + xlab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 2))
mat <- matrix(c(1, 2),
nrow = 1)
pf <- grid.arrange(f11, f22, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat1', plot = pf, height = 3, width = 6)
View(f4)
ggsave2x('../plots-meas/dig.prop.supMat1', plot = pf, height = 4, width = 6)
ggsave2x('../plots-meas/dig.prop.supMat1', plot = pf, height = 3.5, width = 6)
ggsave2x('../plots-meas/dig.prop.supMat1', plot = pf, height = 3, width = 5)
ggsave2x('../plots-meas/dig.prop.supMat1', plot = pf, height = 3, width = 5.5)
ggsave2x('../plots-meas/dig.prop.supMat1', plot = pf, height = 3.5, width = 5.5)
f1 <- ggplot(ds, aes(TS.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank())
f2 <- ggplot(ds, aes(pH.lab.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('pH') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank())
f3 <- ggplot(ds, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Exposed surface area (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank())
f4 <- ggplot(ds, aes(n.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('n') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank())
f5 <- ggplot(ds, aes(TS.mn, area.perc.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank())
f6 <- ggplot(ds, aes(TS.mn, n.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('n') +
theme(legend.position = 'bottom', legend.title = element_blank())
mat <- matrix(c(1, 2,
3, 4,
5, 6),
nrow = 3, byrow = TRUE)
pf <- grid.arrange(f1, f2, f3, f4, f5, f6, layout_matrix = mat)
f1 <- ggplot(ds, aes(TS.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 2))
f2 <- ggplot(ds, aes(pH.lab.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('pH') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 2))
f3 <- ggplot(ds, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Exposed surface area (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 2))
f4 <- ggplot(ds, aes(n.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('n') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 2))
f5 <- ggplot(ds, aes(TS.mn, area.perc.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 2))
f6 <- ggplot(ds, aes(TS.mn, n.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('n') +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 2))
mat <- matrix(c(1, 2,
3, 4,
5, 6),
nrow = 3, byrow = TRUE)
pf <- grid.arrange(f1, f2, f3, f4, f5, f6, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat3', plot = pf, height = 10, width = 7)
f1 <- ggplot(ds, aes(TS.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 3))
f2 <- ggplot(ds, aes(pH.lab.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('pH') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 3))
f3 <- ggplot(ds, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Exposed surface area (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 3))
f4 <- ggplot(ds, aes(n.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('n') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 3))
mat <- matrix(c(1, 2,
3, 4),
nrow = 2, byrow = TRUE)
pf <- grid.arrange(f1, f2, f3, f4, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat2', plot = pf, height = 8, width = 7)
f1 <- ggplot(ds, aes(TS.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(
legend.position = "bottom",
legend.title = element_blank(),
legend.box = "vertical"   # put guides in separate rows
) +
guides(
shape = guide_legend(nrow = 2, order = 1),  # first row, 2 rows of shapes
color = guide_legend(nrow = 1, order = 2)   # second row, colors only
)
f2 <- ggplot(ds, aes(pH.lab.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('pH') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 2))
f3 <- ggplot(ds, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Exposed surface area (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 2))
f4 <- ggplot(ds, aes(n.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('n') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank()) +
guides(shape = guide_legend(nrow = 2))
mat <- matrix(c(1, 2,
3, 4),
nrow = 2, byrow = TRUE)
pf <- grid.arrange(f1, f2, f3, f4, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat2', plot = pf, height = 8, width = 7)
f1 <- ggplot(ds, aes(TS.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(
legend.position = "bottom",
legend.title = element_blank(),
legend.box = "vertical"
) +
guides(
shape = guide_legend(nrow = 2, order = 1),
color = guide_legend(nrow = 1, order = 2)
)
f2 <- ggplot(ds, aes(pH.lab.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('pH') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(
legend.position = "bottom",
legend.title = element_blank(),
legend.box = "vertical"
) +
guides(
shape = guide_legend(nrow = 2, order = 1),
color = guide_legend(nrow = 1, order = 2)
)
f3 <- ggplot(ds, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Exposed surface area (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(
legend.position = "bottom",
legend.title = element_blank(),
legend.box = "vertical"
) +
guides(
shape = guide_legend(nrow = 2, order = 1),
color = guide_legend(nrow = 1, order = 2)
)
f4 <- ggplot(ds, aes(n.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('n') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(
legend.position = "bottom",
legend.title = element_blank(),
legend.box = "vertical"
) +
guides(
shape = guide_legend(nrow = 2, order = 1),
color = guide_legend(nrow = 1, order = 2)
)
mat <- matrix(c(1, 2,
3, 4),
nrow = 2, byrow = TRUE)
pf <- grid.arrange(f1, f2, f3, f4, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat2', plot = pf, height = 10, width = 7)
ggsave2x('../plots-meas/dig.prop.supMat2', plot = pf, height = 8, width = 6)
f1 <- ggplot(ds, aes(TS.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
f2 <- ggplot(ds, aes(pH.lab.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('pH') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
f3 <- ggplot(ds, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Exposed surface area (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
f4 <- ggplot(ds, aes(n.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('n') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
mat <- matrix(c(1, 2,
3, 4),
nrow = 2, byrow = TRUE)
pf <- grid.arrange(f1, f2, f3, f4, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat2', plot = pf, height = 8, width = 6)
f6 <- ggplot(ds, aes(TS.mn, n.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('m') +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
mat <- matrix(c(1, 2,
3, 4,
5, 6),
nrow = 3, byrow = TRUE)
pf <- grid.arrange(f1, f2, f3, f4, f5, f6, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat3', plot = pf, height = 10, width = 7)
f1 <- ggplot(ds, aes(TS.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
f2 <- ggplot(ds, aes(pH.lab.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('pH') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
f3 <- ggplot(ds, aes(area.perc.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Exposed surface area (%)') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
f4 <- ggplot(ds, aes(n.mn, e.rel.150, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('m') + ylab(expression(paste(NH[3],' (% of TAN)'))) +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
mat <- matrix(c(1, 2,
3, 4),
nrow = 2, byrow = TRUE)
pf <- grid.arrange(f1, f2, f3, f4, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat2', plot = pf, height = 8, width = 6)
f5 <- ggplot(ds, aes(TS.mn, area.perc.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
f6 <- ggplot(ds, aes(TS.mn, n.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('m') +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
f7 <- ggplot(ds, aes(TS.mn, K.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('K') +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
mat <- matrix(c(1, 2,
3),
nrow = 2, byrow = TRUE)
View(ds)
library(patchwork)
# keep guide settings in each plot (they will be collected)
f5 <- ggplot(ds, aes(TS.mn, area.perc.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('Exposed surface area (%)') +
guides(shape = guide_legend(nrow = 2, order = 1),
color = guide_legend(nrow = 1, order = 2)) +
theme(legend.title = element_blank(), legend.box = "vertical")
f6 <- ggplot(ds, aes(TS.mn, n.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('m') +
guides(shape = guide_legend(nrow = 2, order = 1),
color = guide_legend(nrow = 1, order = 2))
f7 <- ggplot(ds, aes(TS.mn, K.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('K') +
guides(shape = guide_legend(nrow = 2, order = 1),
color = guide_legend(nrow = 1, order = 2))
# arrange: f5 and f6 side-by-side, f7 below spanning both columns.
combined <- ((f5 + f6) / f7) +
plot_layout(guides = "collect")  # collect one legend from all plots
# apply theme for collected legend (stacked boxes)
combined <- combined & theme(
legend.position = "bottom",
legend.title = element_blank(),
legend.box = "vertical"   # stack separate legend boxes vertically
)
# save
ggsave("../plots-meas/dig.prop.supMat3.png", plot = combined, width = 6, height = 8, dpi = 300)
# Example plots (with guides separated)
f5 <- ggplot(ds, aes(TS.mn, area.perc.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab("Dry matter (%)") + ylab("Exposed surface area (%)") +
guides(shape = guide_legend(nrow = 2, order = 1),
color = guide_legend(nrow = 1, order = 2))
f6 <- ggplot(ds, aes(TS.mn, n.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab("Dry matter (%)") + ylab("m") +
guides(shape = guide_legend(nrow = 2, order = 1),
color = guide_legend(nrow = 1, order = 2))
f7 <- ggplot(ds, aes(TS.mn, K.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab("Dry matter (%)") + ylab("K") +
guides(shape = guide_legend(nrow = 2, order = 1),
color = guide_legend(nrow = 1, order = 2))
# Arrange: f5 and f6 side by side, f7 below them
combined <- ((f5 | f6) / f7) +
plot_layout(guides = "collect", heights = c(1, 1)) # equal heights
# Apply theme for shared legend
combined <- combined & theme(
legend.position = "bottom",
legend.title = element_blank(),
legend.box = "vertical"
)
# Save
ggsave("../plots-meas/dig.prop.supMat3.png", plot = combined,
width = 6, height = 8, dpi = 300)
f5 <- ggplot(ds, aes(TS.mn, area.perc.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('Exposed surface area (%)') +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
f6 <- ggplot(ds, aes(TS.mn, n.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('m') +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
f7 <- ggplot(ds, aes(TS.mn, K.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('K') +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
f8 <- ggplot(ds, aes(TS.mn, pH.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('pH') +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
mat <- matrix(c(1, 2,
3, 4),
nrow = 2, byrow = TRUE)
pf <- grid.arrange(f5, f6, f7, f8, layout_matrix = mat)
f8 <- ggplot(ds, aes(TS.mn, pH.lab.mn, color = dig1, shape = trial.ID)) +
geom_point() +
theme_bw() +
xlab('Dry matter (%)') + ylab('pH') +
theme(legend.position = 'bottom', legend.title = element_blank(), legend.box = 'vertical') +
guides(shape = guide_legend(nrow = 2, order = 1), color = guide_legend(nrow = 1, order = 2))
mat <- matrix(c(1, 2,
3, 4),
nrow = 2, byrow = TRUE)
pf <- grid.arrange(f5, f6, f7, f8, layout_matrix = mat)
ggsave2x('../plots-meas/dig.prop.supMat3', plot = pf, height = 8, width = 6)
